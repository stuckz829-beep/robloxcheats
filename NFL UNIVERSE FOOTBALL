-- Updated 2026 Loader with Secure Mode & Direct Path
getgenv().SecureMode = true -- Required for many 2026 executors to prevent detection/crashing
local Rayfield = loadstring(game:HttpGet('https://sirius.menu/rayfield'))()

local Window = Rayfield:CreateWindow({
   Name = "Ultimate Football Hub 2026",
   LoadingTitle = "Pull Logic Fix Applied...",
   LoadingSubtitle = "by 2026 Stable Loader",
   ConfigurationSaving = { Enabled = false },
   KeySystem = false
})

-- TABS
local MainTab = Window:CreateTab("All Mods", 4483362458)

-- Variables
local UIS = game:GetService("UserInputService")
local RunService = game:GetService("RunService")
local Players = game:GetService("Players")
local localPlayer = Players.LocalPlayer

local isHeadModEnabled, targetHeadScale = false, 1
local isMagEnabled, magRange, isMouseDown = false, 15, false
local visualSphere, currentBall = nil, nil

-- OPTIMIZATION: Search for ball every 0.5s
task.spawn(function()
    while task.wait(0.5) do
        currentBall = workspace:FindFirstChild("Football", true) or workspace:FindFirstChild("Ball", true)
    end
end)

-- Input Handling
UIS.InputBegan:Connect(function(input, gpe) 
    if not gpe and input.UserInputType == Enum.UserInputType.MouseButton1 then isMouseDown = true end 
end)
UIS.InputEnded:Connect(function(input) 
    if input.UserInputType == Enum.UserInputType.MouseButton1 then isMouseDown = false end 
end)

-- CORE LOGIC LOOP (2026 Force-Pull Edition)
RunService.Heartbeat:Connect(function()
    local char = localPlayer.Character
    local hrp = char and char:FindFirstChild("HumanoidRootPart")
    if not hrp then return end

    -- 1. Physics-Bypass Football Magnet
    if currentBall and isMagEnabled then
        -- Sphere Visualization
        if not visualSphere then
            visualSphere = Instance.new("Part")
            visualSphere.Shape, visualSphere.Color = Enum.PartType.Ball, Color3.fromRGB(0, 255, 150)
            visualSphere.Transparency, visualSphere.Material = 0.7, Enum.Material.ForceField
            visualSphere.CanCollide, visualSphere.Anchored, visualSphere.CastShadow = false, true, false
            visualSphere.Parent = workspace
        end
        visualSphere.Size = Vector3.new(magRange * 2, magRange * 2, magRange * 2)
        visualSphere.Position = currentBall.Position

        if isMouseDown then 
            local dist = (hrp.Position - currentBall.Position).Magnitude
            if dist <= magRange then
                -- The "Catch" point: 1.5 studs in front of your character
                local catchPoint = hrp.Position + (hrp.CFrame.LookVector * 1.5)
                
                -- FORCE PULL: Directly setting CFrame and Velocity to bypass server lag
                if dist > 2.5 then
                    -- Smooth travel toward you
                    local lerpFactor = 0.25 -- Speed of the pull (0.1 to 0.5)
                    currentBall.CFrame = currentBall.CFrame:Lerp(CFrame.new(catchPoint), lerpFactor)
                    currentBall.AssemblyLinearVelocity = (catchPoint - currentBall.Position).Unit * 120
                else
                    -- CATCH: Lock ball to hands
                    currentBall.CFrame = CFrame.new(catchPoint)
                    currentBall.AssemblyLinearVelocity = Vector3.new(0,0,0)
                end
            end
        end
    elseif visualSphere then
        visualSphere:Destroy()
        visualSphere = nil
    end

    -- 2. Integrated Persistent Head Collision Logic
    if isHeadModEnabled then
        for _, player in ipairs(Players:GetPlayers()) do
            if player ~= localPlayer and player.Character then
                local head = player.Character:FindFirstChild("Head")
                local humanoid = player.Character:FindFirstChildOfClass("Humanoid")
                
                if head and humanoid then
                    head.Size = Vector3.new(targetHeadScale, targetHeadScale, targetHeadScale)
                    head.Transparency = 0.5
                    
                    local isStandingOnHead = false
                    local rayParam = RaycastParams.new()
                    rayParam.FilterDescendantsInstances = {localPlayer.Character}
                    rayParam.FilterType = Enum.RaycastFilterType.Exclude
                    
                    local ray = workspace:Raycast(hrp.Position, Vector3.new(0, -5, 0), rayParam)
                    if ray and ray.Instance == head then
                        isStandingOnHead = true
                    end

                    local lastJump = humanoid:GetAttribute("LastJumpTime") or 0
                    local timeSinceJump = tick() - lastJump

                    if isStandingOnHead or (timeSinceJump > 0.15 and timeSinceJump < 0.30) then
                        head.CanCollide = true
                    else
                        head.CanCollide = false
                    end
                end
            end
        end
    end
end)



-- UI Setup
MainTab:CreateSection("Player")
MainTab:CreateSlider({Name = "WalkSpeed", Range = {18, 300}, Increment = 1, Suffix = "Speed", CurrentValue = 18, Callback = function(v) if localPlayer.Character:FindFirstChild("Humanoid") then localPlayer.Character.Humanoid.WalkSpeed = v end end})
MainTab:CreateSlider({Name = "Gravity", Range = {0, 196}, Increment = 1, Suffix = "Grav", CurrentValue = 196, Callback = function(v) workspace.Gravity = v end})

MainTab:CreateSection("Football Magnet")
MainTab:CreateToggle({Name = "Enable Mags", CurrentValue = false, Callback = function(v) isMagEnabled = v end})
MainTab:CreateSlider({Name = "Magnet Range", Range = {5, 100}, Increment = 1, Suffix = "Range", CurrentValue = 15, Callback = function(v) magRange = v end})

MainTab:CreateSection("Server Visuals")
MainTab:CreateToggle({Name = "Enable Head Size", CurrentValue = false, Callback = function(v) isHeadModEnabled = v end})
MainTab:CreateSlider({Name = "Head Scale", Range = {1, 15}, Increment = 0.5, CurrentValue = 1, Callback = function(v) targetHeadScale = v end})

Rayfield:Notify({Title = "Hub Loaded", Content = "2026 UI & Persistent Head Logic applied.", Duration = 5})
