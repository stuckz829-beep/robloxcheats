-- Updated 2026 Loader with Noclip, Auto-Pull & Head Bounce - FIXED
getgenv().SecureMode = true

-- Load Rayfield properly
local success, Rayfield = pcall(function()
    return loadstring(game:HttpGet('https://sirius.menu/rayfield'))()
end)
if not success then
    warn("Failed to load Rayfield GUI!")
    return
end

-- CREATE WINDOW
local Window = Rayfield:CreateWindow({
   Name = "Ultimate Football Hub 2026",
   LoadingTitle = "Direct Path Logic Applied...",
   LoadingSubtitle = "by unknown",
   ConfigurationSaving = { Enabled = true },
   KeySystem = false
})

-- SERVICES
local Players = game:GetService("Players")
local RunService = game:GetService("RunService")
local localPlayer = Players.LocalPlayer

-- VARIABLES
local UIS = game:GetService("UserInputService")
local isHeadModEnabled, targetHeadScale = false, 1
local isBounceEnabled, bouncePower = false, 50
local isMagEnabled, magRange = false, 15
local isNoclipEnabled = false
local currentBall, visualSphere = nil, nil

-- BALL SEARCH
task.spawn(function()
    while task.wait(0.5) do
        currentBall = workspace:FindFirstChild("Football", true) or workspace:FindFirstChild("Ball", true)
    end
end)

-- WAIT FOR CHARACTER
local function waitForChar()
    local char = localPlayer.Character or localPlayer.CharacterAdded:Wait()
    local hrp = char:WaitForChild("HumanoidRootPart")
    local hum = char:WaitForChild("Humanoid")
    return char, hrp, hum
end

-- CORE LOOP
RunService.Stepped:Connect(function()
    local char, hrp, hum = localPlayer.Character, nil, nil
    if char then
        hrp = char:FindFirstChild("HumanoidRootPart")
        hum = char:FindFirstChildOfClass("Humanoid")
    end
    if not hrp or not hum then return end

    -- NOCLIP
    if isNoclipEnabled then
        for _, part in ipairs(char:GetDescendants()) do
            if part:IsA("BasePart") then
                part.CanCollide = false
            end
        end
    end

    -- MAGNET LOGIC
    local function isHeldByOthers()
        if not currentBall then return false end
        local parent = currentBall.Parent
        if parent:FindFirstChildOfClass("Humanoid") and parent ~= char then return true end
        return false
    end

if currentBall and isMagEnabled and not isHeldByOthers() then
    local dist = (hrp.Position - currentBall.Position).Magnitude
    local catchPoint = hrp.Position + (hrp.CFrame.LookVector * 1.5)

    if dist > 3 then
        -- Smooth pull using velocity, avoids flinging
        local direction = (catchPoint - currentBall.Position)
        currentBall.AssemblyLinearVelocity = direction.Unit * math.clamp(direction.Magnitude * 10, 0, 150)
    else
        -- When very close, gently move ball without teleporting
        currentBall.AssemblyLinearVelocity = Vector3.new(0,0,0)
        currentBall.CFrame = currentBall.CFrame:Lerp(CFrame.new(catchPoint), 0.1)
    end

    -- Sphere visualization
    if not visualSphere then
        visualSphere = Instance.new("Part")
        visualSphere.Shape = Enum.PartType.Ball
        visualSphere.Color = Color3.fromRGB(0, 255, 150)
        visualSphere.Material = Enum.Material.ForceField
        visualSphere.Transparency = 0.5
        visualSphere.Anchored = true
        visualSphere.CanCollide = false
        visualSphere.Parent = workspace
    end
    visualSphere.Size = Vector3.new(magRange*2, magRange*2, magRange*2)
    visualSphere.Position = currentBall.Position
elseif visualSphere then
    visualSphere:Destroy()
    visualSphere = nil
end


    -- HEAD MOD & BOUNCE
    if isHeadModEnabled then
        for _, player in ipairs(Players:GetPlayers()) do
            if player ~= localPlayer and player.Character then
                local head = player.Character:FindFirstChild("Head")
                if head then
                    head.Size = Vector3.new(targetHeadScale, targetHeadScale, targetHeadScale)
                    head.Transparency = 0.5

                    -- Bounce detection
                    local rayParam = RaycastParams.new()
                    rayParam.FilterDescendantsInstances = {char}
                    rayParam.FilterType = Enum.RaycastFilterType.Exclude
                    local rayLength = (hrp.Position.Y - head.Position.Y) + 1
                    local ray = workspace:Raycast(hrp.Position, Vector3.new(0, -rayLength, 0), rayParam)

                    if ray and ray.Instance == head then
                        head.CanCollide = true
                        if isBounceEnabled and hrp.AssemblyLinearVelocity.Y < 0 then
                            hrp.AssemblyLinearVelocity = Vector3.new(hrp.AssemblyLinearVelocity.X, bouncePower, hrp.AssemblyLinearVelocity.Z)
                        end
                    else
                        head.CanCollide = false
                    end
                end
            end
        end
    end
end)

-- GUI
local MainTab = Window:CreateTab("All Mods", 4483362458)

MainTab:CreateSection("Player Physics")
MainTab:CreateSlider({
    Name = "Player Gravity", 
    Range = {1, 196.2}, 
    Increment = 1, 
    Suffix = "Gravity", 
    CurrentValue = 196.2, 
    Callback = function(v) workspace.Gravity = v end
})
MainTab:CreateToggle({Name = "Noclip", CurrentValue = false, Callback = function(v) isNoclipEnabled = v end})
MainTab:CreateSlider({Name = "WalkSpeed", Range = {18, 200}, Increment = 1, Suffix = "Speed", CurrentValue = 18, Callback = function(v)
    if localPlayer.Character:FindFirstChild("Humanoid") then
        localPlayer.Character.Humanoid.WalkSpeed = v
    end
end})

MainTab:CreateSection("Football Magnet")
MainTab:CreateToggle({Name = "Auto-Pull Football", CurrentValue = false, Callback = function(v) isMagEnabled = v end})
MainTab:CreateSlider({Name = "Mags Range", Range = {5, 100}, Increment = 1, Suffix = "Studs", CurrentValue = 15, Callback = function(v) magRange = v end})

MainTab:CreateSection("Head Mod & Bounce")
MainTab:CreateToggle({Name = "Enable Head Size", CurrentValue = false, Callback = function(v) isHeadModEnabled = v end})
MainTab:CreateSlider({Name = "Head Size", Range = {1, 15}, Increment = 0.5, CurrentValue = 1, Callback = function(v) targetHeadScale = v end})
MainTab:CreateToggle({Name = "Enable Boost Tech", CurrentValue = false, Callback = function(v) isBounceEnabled = v end})
MainTab:CreateSlider({Name = "Boost Tech", Range = {30, 150}, Increment = 5, CurrentValue = 50, Callback = function(v) bouncePower = v end})

Rayfield:Notify({Title = "2026 Stable Loaded", Content = "Gravity & Bounce logic ready.", Duration = 5})
